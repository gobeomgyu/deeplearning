#DT 작업

import pandas as pd

# 붓꽃 데이터 CSV 파일 읽기
file_path = "C:\\Users\\LG\\Downloads\\iris.csv"  # 본인이 iris.csv를 저장한 경로를 입력합니다.
df = pd.read_csv(file_path)

# 데이터프레임 확인
print(df.head())  # 첫 5개 행 출력
print(df.columns)  # 컬럼명 출력

import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier, plot_tree

# 1. CSV 파일 불러오기
file_path = "C:\\Users\\LG\\Downloads\\iris.csv"  # 본인의 파일 경로 입력
df = pd.read_csv(file_path)

# 2. 데이터 전처리 (특성과 타겟 분리)
X = df.drop(columns=["Name"])  # 특성(Feature)
y = df["Name"]  # 타겟(Label)

# 3. 데이터 분할 (학습용 80%, 테스트용 20%)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 4. 결정 트리 모델 학습
dt_model = DecisionTreeClassifier(max_depth=3, random_state=42)  # 트리 깊이 제한
dt_model.fit(X_train, y_train)

# 5. 결정 트리 시각화
plt.figure(figsize=(12, 8))
plot_tree(dt_model, feature_names=X.columns, class_names=y.unique(), filled=True, rounded=True)
plt.title("Decision Tree Visualization")
plt.show()
